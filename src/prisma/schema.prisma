// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "darwin", "darwin-arm64", "linux-musl", "debian-openssl-1.1.x", "darwin"]
  previewFeatures = ["interactiveTransactions"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id                      Int    @id @default(autoincrement())
  nome_completo           String 
  telefone                String @unique @db.VarChar(11)
  email                   String @unique
  cpf                     String @unique @db.VarChar(11)
  senha                   String 
  data_nascimento         DateTime
  endereco                Endereco?
  conta_bancaria          Conta_Bancaria? 
}

model Endereco {
  id                      Int   @id @default(autoincrement())
  usuario                 Usuario @relation(fields: [id_usuario], references: [id])
  id_usuario              Int @unique
  cep                     String @db.VarChar(8) 
  rua                     String
  bairro                  String
  cidade                  String
  numero                  Int
  UF                      String @db.VarChar(2) 
  complemento             String @db.VarChar(1) 
}

model Conta_Bancaria {
  id                      Int   @id @default(autoincrement())
  usuario                 Usuario @relation(fields: [id_usuario], references: [id])
  id_usuario              Int @unique
  numero_conta            String @unique
  agencia                 String
  saldo                   Float @default(0)
  senha_transacional      String @db.VarChar(4)
  nome_banco              String @default("RubBank")
  status_conta            status_conta
  remetente               Transferencia[] @relation("remetente")
  destinatario            Transferencia[] @relation("destinatario")
}

model Transferencia {
  id                    Int   @id @default(autoincrement())
  remetente             Conta_Bancaria @relation("remetente", fields: [id_remetente], references:[id])
  destinatario          Conta_Bancaria @relation("destinatario", fields: [id_destinatario], references:[id])
  id_remetente          Int @unique
  id_destinatario       Int @unique
  data_transferencia    DateTime @default(now())
  valor                 Float
  descricao             String
  status                status_transfer
}

enum status_transfer {
  pendente
  confirmada
  recusada
}


enum status_conta {
  ativa
  inativa
  bloqueada
}
